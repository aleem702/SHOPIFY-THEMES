<link rel="preload" href="{{ 'collapsible-content.css' | asset_url }}" as="style" onload="this.onload=null;this.rel='stylesheet'">
{% render 'accordion-css' %}
{%- liquid
   assign global_heading_size = settings.enable_global_heading_font_size
   assign global_color = settings.enable_global_color
   assign section_id_variable = section.id
-%}

{% if request.visual_preview_mode %}
  {% comment %} For some reason, using actual section id in preview messes up the preview render. Doing this fixes it. {% endcomment %}
  {% assign section_id_variable = "id" %}
{% endif %}

{%- style -%}
  {%- if request.visual_preview_mode -%}
    {% comment %} don't want fade-in animation in preview mode because it messes up preview {% endcomment %}
    .animation_section,
    .animation_section * {
      opacity: 1 !important;
      transform: none !important;
      transition: none !important;
      will-change: auto !important;
    }
  {%- endif -%}

  #shopify-section-{{ section_id_variable }} .section__collapsible_content {
    padding: 5px 0;
    margin: -1px 0;
  }

  .section-{{ section_id_variable }}-padding {
    padding-top: {{ section.settings.padding_top | times: 0.75 | round: 0 }}px;
    padding-bottom: {{ section.settings.padding_bottom | times: 0.75 | round: 0 }}px;
  }

  @media screen and (min-width: 750px) {
    .section-{{ section_id_variable }}-padding {
      padding-top: {{ section.settings.padding_top }}px;
      padding-bottom: {{ section.settings.padding_bottom }}px;
    }
  }

  .allAccordionButtonsContainer-{{ section_id_variable }} {
    display: flex;
    flex-direction: column;
    {%  if section.settings.layout == "row" %}
      gap: 15px;
    {% endif %}
  }

  .singleAccordianContainer-{{ section_id_variable }} {
    {%  if section.settings.layout == "row" %}
      background-color: {{ section.settings.row_container_bg_color_scheme }};
      border-radius: 10px;
    {% endif %}
  }

  .accordionButtonStyle-{{ section_id_variable }} {
    border: none;
    border-top: 2px solid rgba(0,0,0,0.07);
    display: block;
    background-color: transparent;
    color: #444;
    cursor: pointer;
    padding: 23px 15px;
    width: 100%;
    text-align: left;
    outline: none;
    transition: 0.1s;
    cursor: pointer;
    -ms-touch-action: manipulation;
    touch-action: manipulation;
    -webkit-tap-highlight-color: transparent;

    {%  if section.settings.layout == "row" %}
      padding: 25px;
      border: none !important;
    {% endif %}
  }
  .singleAccordianContainer-{{ section_id_variable }}:last-of-type {
    {%  if section.settings.layout != "row" %}
      border-bottom: 2px solid rgba(0,0,0,0.07);
    {% endif %}
  }

  .accordionButtonStyle-{{ section_id_variable }}:hover .collapsibleTitleSpan-{{ section_id_variable }} {
    text-decoration: underline;
  }

  .panelStyle-{{ section_id_variable }} {
    padding: 0 25px;
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease-in-out;
  }

  .panelStyle-{{ section_id_variable }} p {
    line-height: 1.4em;
    {%  if section.settings.layout == "row" %}
      margin-top: 0px;
      margin-bottom: 25px !important;
    {% else %}
      margin-top: 5px;
    {% endif %}
  }

  .accordionButtonStyle-{{ section_id_variable }} svg.icon-caret, .accordionButtonStyle-{{ section_id_variable }} svg.icon-caret path {
      transform: rotate(0deg);
      transition: 0.4s;
      width: 24px;
      min-width: 24px;
      height: 24px;
      min-height: 24px;
      margin-left: 12px;
  }

  @media (max-width: 767px) {
    .accordionButtonStyle-{{ section_id_variable }} svg.icon-caret, .accordionButtonStyle-{{ section_id_variable }} svg.icon-caret path {
      width: 19px !important;
      min-width: 19px !important;
      height: 19px !important;
      min-height: 19px !important;

    }
  }

  .accordionButtonStyle-{{ section_id_variable }}.active svg.icon-caret {
    transform: rotate(180deg);
  }

  .accordianTitle-{{ section_id_variable }} {
    margin: 0px;
  }

  .boldText-{{ section_id_variable }} .material-icon {
    {% if section.settings.bold_row_title  %}
    font-weight: 600;
    {% endif  %}
  }
  .boldText-{{ section_id_variable }} .collapsibleTitleSpan-{{ section_id_variable }} {
    {% if section.settings.bold_row_title  %}
    font-weight: 700;
    {% endif  %}
  }

  .accordianTitle-{{ section_id_variable }} span.material-icon.material-symbols-outlined svg{
    fill: {{ section.settings.icon_color }};
    width: 24px;
    height: 24px;
  }
  .accordianTitle-{{ section_id_variable }} span.material-icon.material-symbols-outlined{
    display: flex;
    align-items: center;
  }

  svg.icon-caret path {
    fill: {{ section.settings.arrow_color }};
  }
{%- endstyle -%}

<div class="color-{{ section.settings.color_scheme }} gradient section__collapsible_content">
  <div class="collapsible-content collapsible-{{ section.settings.layout }}-layout isolate{% if section.settings.layout == 'section' %} page-width{% elsif section.settings.layout == 'none' %} content-container content-container--full-width{% endif %}">
    <div class="collapsible-content__wrapper section-{{ section_id_variable }}-padding">
      <div class="{% if section.settings.image == blank %}collapsible-content-wrapper-narrow{% else %}page-width{% endif %}">
        <div class="collapsible-content__header" style="text-align: {{ section.settings.heading_alignment }};">
          {%- if section.settings.caption != blank -%}
            <p class="caption-with-letter-spacing">{{ section.settings.caption | escape }}</p>
          {% endif %}
          {%- if section.settings.heading != blank -%}
            {% style %}
              #section-heading-{{ section_id_variable }}{
                  font-size: {% if global_heading_size %}var(--font-heading-size) !important{% else %}{{ section.settings.font_size }}px!important{% endif %};
                  color: {% if global_color %}rgb(var(--color-base-heading)){% else %}{{ section.settings.heading_color }}{% endif %};
                  --color-highlighted-color: {{ section.settings.heading_highlighted_color }};
              }
              #section-heading-{{ section_id_variable }} strong {
                {%- if section.settings.heading_use_gradient -%}
                  background: {% if section.settings.heading_gradient_color != blank %}{{ section.settings.heading_gradient_color }}{% else %}var(--gradient-base-background-1){% endif %};
                  -webkit-background-clip: text;
                  background-clip: text;
                  color: transparent;
                {%- endif -%}
              }
              @media (max-width: 768px) {
                #section-heading-{{ section_id_variable }}{
                  font-size: {% if global_heading_size %}var(--font-heading-mob-size) !important{% else %}{{ section.settings.mob_font_size }}px!important{% endif %};
                }
              }
            {% endstyle %}

            <h2
              id="section-heading-{{ section_id_variable }}"
              class="title collapsible-content__heading {{ section.settings.heading_size }}"
            >
              {{ section.settings.heading }}
            </h2>
          {%- else -%}
            <h2 class="visually-hidden">{{ 'accessibility.collapsible_content_title' | t }}</h2>
          {% endif %}
        </div>
        <div class="grid grid--1-col grid--2-col-tablet collapsible-content__grid{% if section.settings.desktop_layout == 'image_second' %} collapsible-content__grid--reverse{% endif %}">
          {%- if section.settings.image != blank -%}
            <div
              style="overflow: hidden; border-radius: 10px;"
              class="grid__item collapsible-content__grid-item"
            >
              <div
                class="collapsible-content__media collapsible-content__media--{{ section.settings.image_ratio }} media global-media-settings gradient"
                {% if section.settings.image_ratio == 'adapt' %}
                  style="padding-bottom: {{ 1 | divided_by: section.settings.image.aspect_ratio | times: 100 }}%;"
                {% endif %}
              >
                {%- capture sizes -%}
                  (min-width: {{ settings.page_width }}px) {{ settings.page_width | minus: 100 | divided_by: 2 }}px,
                  (min-width: 750px) calc((100vw - 130px) / 2), calc((100vw - 50px) / 2)
                {%- endcapture -%}
                {{
                  section.settings.image
                  | image_url: width: 1800
                  | image_tag: loading: 'lazy', sizes: sizes, widths: '165, 360, 535, 750, 1070, 1250, 1500'
                }}
              </div>
            </div>
          {% endif %}
          <div class="grid__item">
            <div class="allAccordionButtonsContainer-{{ section_id_variable }} fade-in-child">
              {%- for block in section.blocks -%}
                {% style %}
                  .block-{{ block.id }} .collapsibleTitleSpan-{{ section_id_variable }} {
                    font-size: {{ block.settings.heading_font_size }}px;
                  }
                  .block-{{ block.id }} .panelStyle-{{ section_id_variable }} p {
                    font-size: {{ block.settings.body_font_size }}px;
                  }
                {% endstyle %}
                <div class="singleAccordianContainer-{{ section_id_variable }} block-{{ block.id }}" {{ block.shopify_attributes }}>
                  <button class="accordionButtonStyle-{{ section_id_variable }}">
                    <div style="display: flex; justify-content: space-between; align-items: center;">
                      <h3
                        class="accordianTitle-{{ section_id_variable }} rowTitleColor-{{ section_id_variable }} boldText-{{ section_id_variable }}"
                      >
                        <div style="display: flex; align-items: center; gap: 14px;">
                          {% if block.settings.show_custom_icon and block.settings.icon != blank %}
                            <span class="material-icon material-symbols-outlined icon-{{ block.id }} notranslate">
                              {{  block.settings.icon }}
                            </span>
                          {% endif %}
                          <span 
                            class="collapsibleTitleSpan-{{ section_id_variable }} collapsible_title_span" 
                            style="
                              --color-highlighted-color: {{ block.settings.heading_highlighted_color }}; 
                              color: {% if global_color %}rgb(var(--color-base-heading)){% else %}{{ block.settings.heading_color }}{% endif %};
                            "
                          >
                            {{ block.settings.heading }}
                          </span>
                        </div>
                      </h3>
                      <svg
                        aria-hidden="true"
                        focusable="false"
                        class="icon icon-caret rowTitleColor-{{ section_id_variable }}"
                        viewBox="0 0 10 6"
                        width="100"
                        height="100"
                      >
                        <path d="M9.354.646a.5.5 0 0 0-.708 0L5 4.293 1.354.646a.5.5 0 0 0-.708.708l4 4a.5.5 0 0 0 .708 0l4-4a.5.5 0 0 0 0-.708">
                      </svg>
                    </div>
                  </button>
                  <div 
                    class="panelStyle-{{ section_id_variable }} collapsible-body-text" 
                    style="
                      --color-highlighted-color: {{ block.settings.body_highlighted_color }}; 
                      color: {% if global_color %}rgb(var(--color-base-text)){% else %}{{ block.settings.body_color }}{% endif %};
                    "
                  >
                    {{ block.settings.row_content }}
                  </div>
                </div>
              {%- endfor -%}
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

<script>
  function initCollapsibles{{ section.id | replace: '-', '' }}() {
    const acc = document.getElementsByClassName("accordionButtonStyle-{{ section.id }}");
    for (let i = 0; i < acc.length; i++) {
      acc[i].addEventListener("click", function() {
        this.classList.toggle("active");
        const panel = this.nextElementSibling;
        panel.style.maxHeight = panel.style.maxHeight ? null : (panel.scrollHeight + 25) + "px";
      });
    }
  }

  document.addEventListener('DOMContentLoaded', () => setTimeout(initCollapsibles{{ section.id | replace: '-', '' }}, 550));
  document.addEventListener('shopify:section:load', () => setTimeout(initCollapsibles{{ section.id | replace: '-', '' }}, 550));
  document.addEventListener('shopify:section:unload', () => setTimeout(initCollapsibles{{ section.id | replace: '-', '' }}, 550));
</script>

{% schema %}
{
  "name": "FAQ's",
  "tag": "section",
  "class": "section animation_section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "inline_richtext",
      "id": "heading",
      "label": "t:sections.collapsible_content.settings.heading.label",
      "default": "Frequently Asked Questions"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "t:sections.collapsible_content.settings.image.label"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "desktop_layout",
      "options": [
        {
          "value": "image_first",
          "label": "t:sections.collapsible_content.settings.desktop_layout.options__1.label"
        },
        {
          "value": "image_second",
          "label": "Content first"
        }
      ],
      "default": "image_first",
      "label": "Desktop image placement",
      "info": "t:sections.collapsible_content.settings.desktop_layout.info"
    },
    {
      "type": "select",
      "id": "image_ratio",
      "options": [
        {
          "value": "adapt",
          "label": "t:sections.collapsible_content.settings.image_ratio.options__1.label"
        },
        {
          "value": "small",
          "label": "t:sections.collapsible_content.settings.image_ratio.options__2.label"
        },
        {
          "value": "large",
          "label": "t:sections.collapsible_content.settings.image_ratio.options__3.label"
        }
      ],
      "default": "adapt",
      "label": "Image size"
    },
    {
      "type": "select",
      "id": "heading_alignment",
      "label": "t:sections.collapsible_content.settings.heading_alignment.label",
      "options": [
        {
          "value": "left",
          "label": "t:sections.collapsible_content.settings.heading_alignment.options__1.label"
        },
        {
          "value": "center",
          "label": "t:sections.collapsible_content.settings.heading_alignment.options__2.label"
        },
        {
          "value": "right",
          "label": "t:sections.collapsible_content.settings.heading_alignment.options__3.label"
        }
      ],
      "default": "center"
    },
    {
      "type": "range",
      "id": "font_size",
      "label": "Desktop heading size",
      "min": 20,
      "max": 50,
      "step": 1,
      "unit": "px",
      "default": 35
    },
    {
      "type": "range",
      "id": "mob_font_size",
      "label": "Mobile heading size",
      "min": 10,
      "max": 40,
      "step": 1,
      "unit": "px",
      "default": 25
    },
    {
      "type": "header",
      "content": "Styling"
    },
    {
      "type": "select",
      "id": "layout",
      "label": "Container style",
      "options": [
        {
          "value": "row",
          "label": "t:sections.collapsible_content.settings.layout.options__2.label"
        },
        {
          "value": "none",
          "label": "t:sections.collapsible_content.settings.layout.options__1.label"
        },
        {
          "value": "section",
          "label": "t:sections.collapsible_content.settings.layout.options__3.label"
        }
      ],
      "default": "none"
    },
    {
      "type": "checkbox",
      "id": "bold_row_title",
      "label": "Bold text",
      "default": false
    },
    {
      "type": "color",
      "id": "heading_color",
      "label": "Heading color",
      "default": "#383838"
    },
    {
      "type": "color",
      "id": "heading_highlighted_color",
      "label": "Bolded heading color",
      "default": "#383838"
    },
    {
      "type": "checkbox",
      "id": "heading_use_gradient",
      "label": "Use gradient for heading",
      "info": "Any text formatted as bold within the heading will be converted to a gradient.",
      "default": false
    },
    {
      "type": "color_background",
      "id": "heading_gradient_color",
      "label": "Heading gradient color"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "options": [
        {
          "value": "accent-1",
          "label": "t:sections.all.colors.accent_1.label"
        },
        {
          "value": "accent-2",
          "label": "t:sections.all.colors.accent_2.label"
        },
        {
          "value": "accent-3",
          "label": "t:sections.all.colors.accent_3.label"
        },
        {
          "value": "custom-color-1",
          "label": "t:sections.all.colors.custom_color_1.label"
        },
        {
          "value": "custom-color-2",
          "label": "t:sections.all.colors.custom_color_2.label"
        },
        {
          "value": "custom-color-3",
          "label": "t:sections.all.colors.custom_color_3.label"
        },
        {
          "value": "custom-color-4",
          "label": "t:sections.all.colors.custom_color_4.label"
        },
        {
          "value": "custom-color-5",
          "label": "t:sections.all.colors.custom_color_5.label"
        },
        {
          "value": "inverse",
          "label": "t:sections.all.colors.inverse.label"
        },
        {
          "value": "gradient-background-1",
          "label": "t:sections.all.colors.gradient_background_1.label"
        }
      ],
      "default": "accent-2",
      "label": "Section color scheme"
    },
    {
      "type": "color",
      "id": "row_container_bg_color_scheme",
      "default": "#FFFFFF",
      "label": "Row container"
    },
    {
      "type": "color",
      "id": "icon_color",
      "default": "#000000",
      "label": "Icon color"
    },
    {
      "type": "color",
      "id": "arrow_color",
      "default": "#000000",
      "label": "Arrow color"
    },
    {
      "type": "header",
      "content": "Padding"
    },
    {
      "type": "range",
      "id": "padding_top",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_top",
      "default": 24
    },
    {
      "type": "range",
      "id": "padding_bottom",
      "min": 0,
      "max": 100,
      "step": 4,
      "unit": "px",
      "label": "t:sections.all.padding.padding_bottom",
      "default": 24
    }
  ],
  "blocks": [
    {
      "type": "collapsible_row",
      "name": "t:sections.collapsible_content.blocks.collapsible_row.name",
      "settings": [
        {
          "type": "inline_richtext",
          "id": "heading",
          "default": "Frequently Asked Questions",
          "label": "Heading",
          "info": "t:sections.collapsible_content.blocks.collapsible_row.settings.heading.info"
        },
        {
          "type": "richtext",
          "id": "row_content",
          "label": "Body",
          "default": "<p>Enter text content...</p>"
        },
        {
          "type": "checkbox",
          "id": "show_custom_icon",
          "default": true,
          "label": "Show Icon"
        },
        {
          "type": "textarea",
          "id": "icon",
          "default": "<svg xmlns=\"http://www.w3.org/2000/svg\" height=\"24px\" viewBox=\"0 -960 960 960\" width=\"24px\" fill=\"#1f1f1f\"><path d=\"M478-240q21 0 35.5-14.5T528-290q0-21-14.5-35.5T478-340q-21 0-35.5 14.5T428-290q0 21 14.5 35.5T478-240Zm-36-154h74q0-33 7.5-52t42.5-52q26-26 41-49.5t15-56.5q0-56-41-86t-97-30q-57 0-92.5 30T342-618l66 26q5-18 22.5-39t53.5-21q32 0 48 17.5t16 38.5q0 20-12 37.5T506-526q-44 39-54 59t-10 73Zm38 314q-83 0-156-31.5T197-197q-54-54-85.5-127T80-480q0-83 31.5-156T197-763q54-54 127-85.5T480-880q83 0 156 31.5T763-763q54 54 85.5 127T880-480q0 83-31.5 156T763-197q-54 54-127 85.5T480-80Zm0-80q134 0 227-93t93-227q0-134-93-227t-227-93q-134 0-227 93t-93 227q0 134 93 227t227 93Zm0-320Z\"/></svg>",
          "label": "Icon SVG",
          "info": "You can get SVG codes from [Google Material Icons](https://material.io/tools/icons)"
        },
        {
          "type": "header",
          "content": "Layout"
        },
        {
          "type": "range",
          "id": "heading_font_size",
          "label": "Heading font size",
          "min": 10,
          "max": 30,
          "step": 1,
          "unit": "px",
          "default": 16
        },
        {
          "type": "range",
          "id": "body_font_size",
          "label": "Body font size",
          "min": 10,
          "max": 30,
          "step": 1,
          "unit": "px",
          "default": 16
        },
        {
          "type": "header",
          "content": "Styling"
        },
        {
          "type": "color",
          "id": "heading_color",
          "label": "Heading color",
          "default": "#383838"
        },
        {
          "type": "color",
          "id": "heading_highlighted_color",
          "label": "Bolded heading color",
          "default": "#383838"
        },
        {
          "type": "color",
          "id": "body_color",
          "label": "Body color",
          "default": "#302f2f"
        },
        {
          "type": "color",
          "id": "body_highlighted_color",
          "label": "Bolded body color",
          "default": "#302f2f"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "FAQ's",
      "blocks": [
        {
          "type": "collapsible_row"
        },
        {
          "type": "collapsible_row"
        },
        {
          "type": "collapsible_row"
        },
        {
          "type": "collapsible_row"
        }
      ]
    }
  ]
}
{% endschema %}
